<div class="card p-3">
  <h2 class="text-xl font-semibold mb-3">Inventario de Productos</h2>

  <p-table
    #dt
    [value]="productList"
    dataKey="id"
    [rows]="5"
    [rowsPerPageOptions]="[5,10,25]"
    [paginator]="true"
    [loading]="loading"
    [globalFilterFields]="['name', 'category.name', 'inventoryState']"
    size="small"
    [showCurrentPageReport]="true"
    currentPageReportTemplate="Mostrando {first} a {last} de {totalRecords} productos"
    [scrollable]="false"
   
  >
    <!-- Buscador global -->
    <ng-template #caption>
      <div class="flex justify-end mb-2">
        
 <input pInputText type="text" (input)="dt.filterGlobal($event.target.value, 'contains')" placeholder="Search keyword" />      </div>
    </ng-template>

    <!-- Header -->
    <ng-template #header>
      <tr>
        <th>Imagen</th>
        <th>Nombre</th>
        <th>Categor√≠a</th>
        <th>Estado</th>
        <th>Precio</th>
        <th>Stock</th>
        <th>Acciones</th>
      </tr>
    </ng-template>

    <!-- Body -->
    <ng-template #body let-product>
      <tr class="text-sm">
        <td class="text-center">
          <img [src]="getImageUrl(product.image)" [alt]="product.name" class="w-20 h-20 object-cover rounded-md mx-auto" />
        </td>
        <td class="font-medium truncate max-w-xs">{{ product.name }}</td>
        <td class="truncate max-w-xs">{{ product.category.name }}</td>
        <td>
          <p-tag [value]="product.inventoryState" [severity]="getSeverity(product.inventoryState)" class="text-xs py-1 px-2"></p-tag>
        </td>
        <td>{{ product.price | currency:'Bs. ' }}</td>
        <td>{{ product.stock }}</td>
        <td class="flex gap-1 flex-wrap justify-center">
          <button pButton icon="pi pi-upload" class="p-button-sm" (click)="fileInput.click()" title="Subir foto"></button>
          <input type="file" #fileInput accept="image/*" style="display:none" (change)="onFileSelected($event, product)" />

          <button pButton icon="pi pi-shopping-cart" class="p-button-sm" [disabled]="product.inventoryState === 'AGOTADO'" title="Agregar al carrito"></button>
          <button pButton icon="pi pi-heart" outlined class="p-button-sm" title="Agregar a favoritos"></button>
        </td>
      </tr>
    </ng-template>

    <!-- Empty -->
    <ng-template #emptymessage>
      <tr>
        <td colspan="7" class="text-center text-sm">No se encontraron productos.</td>
      </tr>
    </ng-template>
  </p-table>
</div>
